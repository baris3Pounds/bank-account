<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>[[${pageTitle}]]</title>
    <link rel="stylesheet" type="text/css" th:href="@{/webjars/bootstrap/css/bootstrap.min.css}" />
</head>
<body>
<div class="container-fluid">
    <div class="text-center" align="center"><h1 style="color: aliceblue">Hesap Özeti</h1></div>
    <form method="post" th:object="${balance}"
          style="max-width: 500px;border: 1px; margin: 0 auto">
        <input type="hidden" th:field="*{user_id}">
        <div id="account-area">
            <div class="container">
                <div class="row">
                    <div class="col-lg-4 mb-3">
                        <div class="submit-area1">
                            <h4>Balance</h4>
                            <h2><span id="current-balance" th:text="*{bakiye}"></span> TL</h2>
                        </div>
                    </div>
                </div>
            </div>

            <div class="container">
                <div class="row">
                    <div class="col-lg-6">
                        <div class="submit-area">
                            <h4>Deposit Amount</h4>
                            <input id="deposit-amount" type="text" class="form-control" placeholder="Enter deposit amount"><br>
                            <label for="currency">Currency:</label>
                            <select id="currency" name="currency">
                                <option value="tl">TL</option>
                                <option value="euro">EURO</option>
                                <option value="usd">USD</option>
                            </select>
                            <button type="button" class="btn btn-primary m-2" th:onclick="withdraw()" >Withdraw</button>
                            <button type="button" class="btn btn-primary m-2" th:onclick="newBakiye()" >Done</button>
                        </div>
                    </div>

                </div>
            </div>
        </div>
    </form>

</div>


<head>
    <style>
        body {
            margin: 0;
            padding-top: 100px;
            background-color: #363958;
        }

        .submit-area {
            padding: 30px;
            margin-top: 50px;
            border-radius: 10px;
            box-shadow: 5px 5px gray;
            color: white;
            background-color: royalblue;
        }
        .submit-area1 {
            padding: 30px;
            margin-top: 50px;
            border-radius: 10px;
            box-shadow: 5px 5px gray;
            color: white;
            background-color: orangered;
        }



    </style>
</head>

<script type="text/javascript">


    function withdraw(){
        let depositStringToInt = getInputNumb('deposit-amount');
        const currencyValue = document.getElementById('currency').value;
        if (currencyValue == "tl" && parseFloat(document.getElementById("current-balance").innerText) >= depositStringToInt){
            updateSpanTest('current-balance', depositStringToInt);
        }
        else if (currencyValue == "euro" && parseFloat(document.getElementById("current-balance").innerText) >= depositStringToInt*15) {
            updateSpanTest('current-balance', depositStringToInt*15);
        }
        else if (currencyValue == "usd" && parseFloat(document.getElementById("current-balance").innerText) >= depositStringToInt*10) {
            updateSpanTest('current-balance', depositStringToInt*10);
        }
        else{
            alert("Yeterli Bakiyeniz bulunmamaktadır.")
        }
    }

    function newBakiye(){
        let newVar = $('bakiye').set(1500);
        window.location= "[[@{/account/balance/{user_id}(user_id=${balance.user_id})}]]";
    }


    function getInputNumb(idName){
        const amount = document.getElementById(idName).value;
        const amountNumber = parseFloat(amount);
        return amountNumber;
    }

    function updateSpanTest(idName, addedNumber){

        const current = document.getElementById(idName).innerText;
        let currentStringToInt = parseFloat(current);

        let total;
        total = currentStringToInt - addedNumber;
        document.getElementById(idName).innerText = total;

    }
    function back(){
        window.location= "[[@{/accounts}]]";
    }

</script>
</body>
</html>